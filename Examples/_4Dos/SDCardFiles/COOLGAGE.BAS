10 LET FR = 0
20 LET PO = 0
30 LET V = 0
40 LET LV = 0
50 LET X = 0
60 LET S = 20
70 LET OP = 0
80 LET RP = 0
90 LET OS = 0
94 LET RR = 74
96 LET RC = 25
100 OPEN4DGFX COOLGA~1
110 GFX ON
120 ORIENTATION 2
130 USERIMAGES 0,0
140 USERIMAGES 1,0
150 IMAGETOUCHENABLE 1
200 LET X = TOUCHX
210 IF TOUCHED = 1
220 LET PO = X - 28
230 LET RP = PO + 8
240 IF PO < 0
250 LET PO = 0
255 ENDIF
260 LET PO = 100 * PO / 189
265 IF PO > 100
270 LET PO = 100
275 ENDIF
310 IF RP > OS
320 LET PS = RP - OS
330 IF OS > 7
340 LET TX = X / 100
345 LET TX = TX + 8
347 USERIMAGESDR 1,PO,OS - TX,3,PS + 22,32
350 ELSE
360 USERIMAGESDR 1,PO,OS,3,PS + 22,32
375 ENDIF
380 ENDIF
390 IF RP < OS
400 LET PS = OS - RP
410 IF RP > 8
420 USERIMAGESDR 1,PO,RP - 8,3,PS + 22,32
430 ELSE
440 USERIMAGESDR 1,PO,RP,3,PS + 22,32
445 ENDIF
450 ENDIF
455 LET OP = PO
457 LET OS = RP
460 IF V < PO
465 LET TV = PO - V
470 IF TV > 5
475 LET V = V + 4
480 ELSE
485 LET V = V + 1
490 ENDIF
495 ENDIF
500 IF V > PO
503 LET TV = V - PO
505 IF TV > 5
510 LET V = V - 4
515 ELSE
520 LET V = V - 1
525 ENDIF
530 ENDIF
535 LET I = 2.7 * V
536 LET I = I + 135
540 IF I > 359
545 LET I = I - 360
550 ENDIF
565 LET RS = I * 3.14 / 180
570 LET OX = COS(RS) * RR + 105
575 LET OY = SIN(RS) * RR + 105
580 LET IX = COS(RS) * RC + 105
585 LET IY = SIN(RS) * RC + 105
600 IF OX < IX AND OY < IY
605 LET OX = OX - S
610 LET IX = IX + S
615 LET OY = OY - S
620 LET IY = IY + S
625 USERIMAGESDR 0,V,OX,OY,IX - OX,IY - OY
630 ENDIF
635 IF OX < IX AND OY > IY
640 LET OX = OX - S
645 LET IX = IX + S
650 LET OY = OY + S
655 LET IY = IY - S
660 USERIMAGESDR 0,V,OX,IY,IX - OX,OY - IY
665 ENDIF
670 IF OX > IX AND OY < IY
675 LET OX = OX + S
680 LET IX = IX - S
685 LET OY = OY - S
690 LET IY = IY + S
695 USERIMAGESDR 0,V,IX,OY,OX - IX,IY - OY
700 ENDIF
705 IF OX > IX AND OY > IY
710 LET OX = OX + S
715 LET IX = IX - S
720 LET OY = OY + S
725 LET IY = IY - S
730 USERIMAGESDR 0,V,IX,IY,OX - IX,OY - IY
735 ENDIF
740 LET LV = V
745 ENDIF
750 IF V < 100
760 USERIMAGESDR 0,V,94,162,28,28
765 ELSE
770 USERIMAGESDR 0,V,92,162,30,28
780 ENDIF
800 GOTO 200
